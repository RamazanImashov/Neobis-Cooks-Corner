## Документация для проекта "Платформа публикации рецептов"

### 1. Общая информация о проекте

**Название проекта:** Платформа публикации рецептов

**Цель проекта:**
Создание платформы, на которой пользователи могут регистрироваться, делиться своими рецептами, добавлять изображения и ингредиенты к каждому рецепту. Пользователи могут также взаимодействовать с рецептами других пользователей — ставить лайки, добавлять в избранное и комментировать.

### 2. Архитектура проекта и основные компоненты

#### Микросервисы
Проект основан на архитектуре с REST API, и все функциональные модули интегрированы в единую Django-платформу с Django Rest Framework (DRF).

- **Управление пользователями:** Модуль, позволяющий регистрировать и авторизовать пользователей, использовать профиль для хранения информации и создавать пользовательские подписки.
- **Рецепты:** Основной модуль, позволяющий создавать, редактировать и просматривать рецепты. Поддерживаются изображения и ингредиенты для каждого рецепта.
- **Интерактивные действия:** Лайки, избранное и комментарии для рецептов.

---

### 3. Используемые технологии

- **Backend**: Django, Django Rest Framework (DRF)
- **База данных**: PostgreSQL
- **Документация API**: Swagger, предоставленный drf-spectacular
- **Аутентификация**: JWT через `rest_framework_simplejwt`
- **Кэширование**: Поддерживается кэширование на уровне представлений для улучшения производительности

---

### 4. Основные модули и их функционал

#### 4.1. Модуль управления пользователями
Этот модуль отвечает за регистрацию, аутентификацию и работу с профилем пользователя. Пользователи могут следить друг за другом, настраивать свой профиль и получать уникальные идентификаторы.

**Модели**:
- **UserProfile**: содержит информацию о пользователе, включая изображение профиля, описание, подписки и список подписчиков.

**Эндпоинты**:
- `POST /register/`: Регистрация нового пользователя.
- `POST /login/`: Авторизация и получение JWT токена.
- `GET /profile/`: Получение информации о профиле пользователя.
- `POST /toggle-subscription/<user_id>/`: Подписка или отписка от пользователя.
  
#### 4.2. Модуль рецептов
Этот модуль позволяет пользователям добавлять рецепты с полным описанием, включая изображения и ингредиенты.

**Модели**:
- **Recipe**: Основная модель для рецептов, содержит название, описание, категорию, время приготовления и сложность.
- **AddRecipeImage**: Хранит изображения для рецептов.
- **AddRecipeIngredient**: Хранит ингредиенты рецептов, включая единицу измерения.

**Эндпоинты**:
- `GET /recipe/`: Получение списка рецептов с фильтрацией по категории и сложности.
- `POST /recipe/`: Создание нового рецепта.
- `GET /recipe/<slug>/`: Подробная информация о рецепте.
- `POST /add_image/`: Добавление изображения к рецепту.
- `POST /add_ingredient/`: Добавление ингредиента к рецепту.

#### 4.3. Модуль взаимодействия с рецептами (Комментарии, Лайки, Избранное)
Модуль взаимодействия позволяет пользователям оставлять комментарии, ставить лайки и добавлять рецепты в избранное.

**Модели**:
- **Comment**: Хранит комментарии к рецептам.
- **Like**: Хранит информацию о лайках рецептов.
- **Favorites**: Хранит информацию о добавлении рецепта в избранное.

**Эндпоинты**:
- `POST /recipe/<slug>/like/`: Добавление или удаление лайка к рецепту.
- `POST /recipe/<slug>/favorites/`: Добавление или удаление рецепта в избранное.
- `POST /recipe/<slug>/comment/`: Добавление комментария к рецепту.

---

### 5. Подробное описание API и пользовательских сценариев

#### Регистрация и аутентификация
1. **Регистрация пользователя**: Пользователь регистрируется, указывая свои данные. После регистрации отправляется код подтверждения.
2. **Аутентификация**: После подтверждения аккаунта пользователь может авторизоваться через JWT.

#### Создание и управление рецептами
1. **Создание рецепта**: Пользователь заполняет данные рецепта, включая название, описание, категорию, сложность и время приготовления. Поддерживается возможность добавлять изображения и ингредиенты.
2. **Редактирование рецепта**: Автор рецепта может обновлять информацию о нем.
3. **Просмотр рецептов**: Пользователи могут искать рецепты по категории, сложности, имени автора и названию.

#### Взаимодействие с рецептами
1. **Лайки и Избранное**: Пользователь может поставить лайк рецепту и добавить его в избранное.
2. **Комментарии**: Пользователь может оставлять комментарии к рецептам других пользователей.

---

### 6. Основные файлы и структура проекта

```plaintext
.
├── apps
│   ├── accounts                     # Модуль для управления пользователями и профилями
│   │   ├── models.py                # Модели для пользователей и профилей
│   │   ├── views.py                 # Вьюшки для регистрации, аутентификации и профилей
│   │   ├── serializers.py           # Сериализаторы для профилей
│   │   └── urls.py                  # URL-маршруты для пользователя
│   │
│   ├── recipe                       # Модуль для работы с рецептами
│   │   ├── models.py                # Модели для рецептов, изображений и ингредиентов
│   │   ├── views.py                 # Вьюшки для работы с рецептами
│   │   ├── serializers.py           # Сериализаторы для рецептов
│   │   └── urls.py                  # URL-маршруты для рецептов
│   │
│   └── review                       # Модуль для взаимодействия с рецептами
│       ├── models.py                # Модели для лайков, комментариев и избранного
│       ├── views.py                 # Вьюшки для комментариев, лайков и избранного
│       ├── serializers.py           # Сериализаторы для взаимодействий
│       └── urls.py                  # URL-маршруты для взаимодействий
│
├── config                           # Настройки Django
│   ├── settings.py                  # Основные настройки проекта
│   ├── urls.py                      # Главный файл URL-маршрутов
│   └── wsgi.py                      # WSGI-конфигурация
├── manage.py                        # Основной скрипт для управления проектом Django
```

### 7. Настройки и переменные окружения

- **.env файл**:
  ```plaintext
  SECRET_KEY=your-secret-key
  DEBUG=True
  DATABASE_URL=your-database-url
  JWT_SECRET_KEY=your-jwt-secret-key
  ```

---

### 8. Пример работы с API

#### Пример запроса на создание рецепта

**Запрос**:
```http
POST /api/v1/recipe/
Content-Type: application/json
Authorization: Bearer <JWT_TOKEN>
{
  "recipe_name": "Шоколадный торт",
  "description": "Лучший шоколадный торт для семейного праздника.",
  "difficulty": "Medium",
  "category": "Dessert",
  "preparation_time": "45 минут"
}
```

**Ответ**:
```json
{
  "slug": "shokoladnyy-tort",
  "recipe_name": "Шоколадный торт",
  "profile": "username",
  "count_like": 0,
  "count_favorite": 0,
  "description": "Лучший шоколадный торт для семейного праздника.",
  "difficulty": "Medium",
  "category": "Dessert",
  "preparation_time": "45 минут",
  "ingredient": [],
  "images": [],
  "comments": []
}
```

---

### 9. Заключение

Платформа публикации рецептов предоставляет пользователям возможность делиться рецептами и взаимодействовать с ними. Это решение легко расширяемо, поддерживает кэширование и может интегрироваться с внешними системами через API.
